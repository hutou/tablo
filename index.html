<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Crystal Docs 1.14.0">
<meta name="crystal_docs.project_version" content="development">
<meta name="crystal_docs.project_name" content="tablo">



<link href="css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/doc.js"></script>

  <meta name="repository-name" content="tablo">
  <title>tablo development</title>
  <script type="text/javascript">
  CrystalDocs.base_path = "";
  </script>
</head>
<body>

<svg class="hidden">
  <symbol id="octicon-link" viewBox="0 0 16 16">
    <path fill="currentColor" fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
  </symbol>
</svg>
<input type="checkbox" id="sidebar-btn">
<label for="sidebar-btn" id="sidebar-btn-label">
  <svg class="open" xmlns="http://www.w3.org/2000/svg" height="2em" width="2em" viewBox="0 0 512 512"><title>Open Sidebar</title><path fill="currentColor" d="M80 96v64h352V96H80zm0 112v64h352v-64H80zm0 112v64h352v-64H80z"></path></svg>
  <svg class="close" xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 512 512"><title>Close Sidebar</title><path fill="currentColor" d="m118.6 73.4-45.2 45.2L210.7 256 73.4 393.4l45.2 45.2L256 301.3l137.4 137.3 45.2-45.2L301.3 256l137.3-137.4-45.2-45.2L256 210.7Z"></path></svg>
</label>
<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="project-summary">
      <h1 class="project-name">
        <a href="index.html">
          tablo
        </a>
      </h1>

      <span class="project-version">
        development
      </span>
    </div>
  </div>

  <div class="search-results hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class="parent " data-id="tablo/Tablo" data-name="tablo">
      <a href="Tablo.html">Tablo</a>
      
        <ul>
  
  <li class="parent " data-id="tablo/Tablo/Border" data-name="tablo::border">
      <a href="Tablo/Border.html">Border</a>
      
        <ul>
  
  <li class=" " data-id="tablo/Tablo/Border/PreSet" data-name="tablo::border::preset">
      <a href="Tablo/Border/PreSet.html">PreSet</a>
      
    </li>
  
  <li class=" " data-id="tablo/Tablo/Border/Styler" data-name="tablo::border::styler">
      <a href="Tablo/Border/Styler.html">Styler</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class="parent " data-id="tablo/Tablo/Cell" data-name="tablo::cell">
      <a href="Tablo/Cell.html">Cell</a>
      
        <ul>
  
  <li class="parent " data-id="tablo/Tablo/Cell/Data" data-name="tablo::cell::data">
      <a href="Tablo/Cell/Data.html">Data</a>
      
        <ul>
  
  <li class=" " data-id="tablo/Tablo/Cell/Data/Coords" data-name="tablo::cell::data::coords">
      <a href="Tablo/Cell/Data/Coords.html">Coords</a>
      
    </li>
  
  <li class=" " data-id="tablo/Tablo/Cell/Data/Formatter" data-name="tablo::cell::data::formatter">
      <a href="Tablo/Cell/Data/Formatter.html">Formatter</a>
      
    </li>
  
  <li class=" " data-id="tablo/Tablo/Cell/Data/Styler" data-name="tablo::cell::data::styler">
      <a href="Tablo/Cell/Data/Styler.html">Styler</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class="parent " data-id="tablo/Tablo/Cell/Text" data-name="tablo::cell::text">
      <a href="Tablo/Cell/Text.html">Text</a>
      
        <ul>
  
  <li class=" " data-id="tablo/Tablo/Cell/Text/Formatter" data-name="tablo::cell::text::formatter">
      <a href="Tablo/Cell/Text/Formatter.html">Formatter</a>
      
    </li>
  
  <li class=" " data-id="tablo/Tablo/Cell/Text/Styler" data-name="tablo::cell::text::styler">
      <a href="Tablo/Cell/Text/Styler.html">Styler</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="tablo/Tablo/CellType" data-name="tablo::celltype">
      <a href="Tablo/CellType.html">CellType</a>
      
    </li>
  
  <li class=" " data-id="tablo/Tablo/Column" data-name="tablo::column(t)">
      <a href="Tablo/Column.html">Column</a>
      
    </li>
  
  <li class="parent " data-id="tablo/Tablo/Config" data-name="tablo::config">
      <a href="Tablo/Config.html">Config</a>
      
        <ul>
  
  <li class=" " data-id="tablo/Tablo/Config/Controls" data-name="tablo::config::controls">
      <a href="Tablo/Config/Controls.html">Controls</a>
      
    </li>
  
  <li class=" " data-id="tablo/Tablo/Config/Defaults" data-name="tablo::config::defaults">
      <a href="Tablo/Config/Defaults.html">Defaults</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class="parent " data-id="tablo/Tablo/Error" data-name="tablo::error">
      <a href="Tablo/Error.html">Error</a>
      
        <ul>
  
  <li class=" " data-id="tablo/Tablo/Error/DuplicateLabel" data-name="tablo::error::duplicatelabel">
      <a href="Tablo/Error/DuplicateLabel.html">DuplicateLabel</a>
      
    </li>
  
  <li class=" " data-id="tablo/Tablo/Error/GroupEmpty" data-name="tablo::error::groupempty">
      <a href="Tablo/Error/GroupEmpty.html">GroupEmpty</a>
      
    </li>
  
  <li class=" " data-id="tablo/Tablo/Error/InvalidBorderDefinition" data-name="tablo::error::invalidborderdefinition">
      <a href="Tablo/Error/InvalidBorderDefinition.html">InvalidBorderDefinition</a>
      
    </li>
  
  <li class=" " data-id="tablo/Tablo/Error/InvalidColumnIndex" data-name="tablo::error::invalidcolumnindex">
      <a href="Tablo/Error/InvalidColumnIndex.html">InvalidColumnIndex</a>
      
    </li>
  
  <li class=" " data-id="tablo/Tablo/Error/InvalidValue" data-name="tablo::error::invalidvalue">
      <a href="Tablo/Error/InvalidValue.html">InvalidValue</a>
      
    </li>
  
  <li class=" " data-id="tablo/Tablo/Error/LabelNotFound" data-name="tablo::error::labelnotfound">
      <a href="Tablo/Error/LabelNotFound.html">LabelNotFound</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class="parent " data-id="tablo/Tablo/Functions" data-name="tablo::functions">
      <a href="Tablo/Functions.html">Functions</a>
      
        <ul>
  
  <li class=" " data-id="tablo/Tablo/Functions/FPAlign" data-name="tablo::functions::fpalign">
      <a href="Tablo/Functions/FPAlign.html">FPAlign</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="tablo/Tablo/Heading" data-name="tablo::heading">
      <a href="Tablo/Heading.html">Heading</a>
      
    </li>
  
  <li class=" " data-id="tablo/Tablo/Justify" data-name="tablo::justify">
      <a href="Tablo/Justify.html">Justify</a>
      
    </li>
  
  <li class=" " data-id="tablo/Tablo/LabelType" data-name="tablo::labeltype">
      <a href="Tablo/LabelType.html">LabelType</a>
      
    </li>
  
  <li class="parent " data-id="tablo/Tablo/Summary" data-name="tablo::summary(t, u, v)">
      <a href="Tablo/Summary.html">Summary</a>
      
        <ul>
  
  <li class=" " data-id="tablo/Tablo/Summary/BodyColumn" data-name="tablo::summary::bodycolumn">
      <a href="Tablo/Summary/BodyColumn.html">BodyColumn</a>
      
    </li>
  
  <li class=" " data-id="tablo/Tablo/Summary/BodyRow" data-name="tablo::summary::bodyrow">
      <a href="Tablo/Summary/BodyRow.html">BodyRow</a>
      
    </li>
  
  <li class=" " data-id="tablo/Tablo/Summary/HeaderColumn" data-name="tablo::summary::headercolumn">
      <a href="Tablo/Summary/HeaderColumn.html">HeaderColumn</a>
      
    </li>
  
  <li class=" " data-id="tablo/Tablo/Summary/UserProc" data-name="tablo::summary::userproc(t)">
      <a href="Tablo/Summary/UserProc.html">UserProc</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="tablo/Tablo/Table" data-name="tablo::table(t)">
      <a href="Tablo/Table.html">Table</a>
      
    </li>
  
  <li class=" " data-id="tablo/Tablo/WrapMode" data-name="tablo::wrapmode">
      <a href="Tablo/WrapMode.html">WrapMode</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<img src="assets/images/logo.png"/>
<h2><a id="table-of-contents" class="anchor" href="#table-of-contents">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Table of contents</h2>
<ul>
<li><a href="#getting-started">Getting started</a></li>
<li><a href="#borders">Borders</a></li>
<li><a href="#row-types">Row types</a>
<ul>
<li><a href="#header-and-body">Header and Body</a></li>
<li><a href="#group">Group</a></li>
<li><a href="#headings">Headings</a></li>
</ul>
</li>
<li><a href="#rules">Rules</a></li>
<li><a href="#display-frequency-and-repeated-title">Display frequency and repeated title</a></li>
<li><a href="#extracting---formatting---styling">Extracting - Formatting - Styling</a>
<ul>
<li><a href="#extracting">Extracting</a></li>
<li><a href="#formatting">Formatting</a></li>
<li><a href="#styling">Styling</a></li>
</ul>
</li>
<li><a href="#packing">Packing</a></li>
<li><a href="#summary">Summary</a></li>
<li><a href="#transpose">Transpose</a></li>
<li><a href="#columns-selection-and-ordering">Columns selection and ordering</a></li>
<li><a href="#tips-and-tricks">Tips and tricks</a></li>
</ul>
<h2><a id="getting-started" class="anchor" href="#getting-started">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Getting started</h2>
<p>In this tutorial, we'll start with a very simple example, which we'll build on
as we go along to gradually discover all the possibilities offered by the
Tablo library.</p>
<p>Here's a first look at how to use Tablo to lay out a simple table from an array
of integers.</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>]) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="s">&quot;itself&quot;</span>, <span class="o">&amp;</span>.itself)
  t.add_column(<span class="n">2</span>, header: <span class="s">&quot;Double&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n <span class="o">*</span> <span class="n">2</span> }
  t.add_column(<span class="n">:column_3</span>, header: <span class="s">&quot;String&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> (<span class="s">&#39;@&#39;</span>.ord <span class="o">+</span> n).chr.to_s <span class="o">*</span> n }
<span class="k">end</span>
puts table</code></pre>
<p>or</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>])
table.add_column(<span class="s">&quot;itself&quot;</span>, <span class="o">&amp;</span>.itself)
table.add_column(<span class="n">2</span>, header: <span class="s">&quot;Double&quot;</span>) {<span class="o">|</span>n<span class="o">|</span> n <span class="o">*</span> <span class="n">2</span>}
table.add_column(<span class="n">:column_3</span>, header: <span class="s">&quot;String&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> (<span class="s">&#39;@&#39;</span>.ord <span class="o">+</span> n).chr.to_s <span class="o">*</span> n }
puts table</code></pre>
<p>output:</p>
<pre><code class="language-crystal">+--------------+--------------+--------------+
|       itself |       Double | String       |
+--------------+--------------+--------------+
|            1 |            2 | A            |
|            2 |            4 | BB           |
|            3 |            6 | CCC          |
+--------------+--------------+--------------+</code></pre>
<p>A great deal of information can already be extracted from this simple example:</p>
<ul>
<li>The only parameter required to create the table is the data source (the
array of integers), but to produce a result, you obviously need to add
columns.</li>
<li>Any number of columns can be defined, each requiring an identifier and
a proc for extracting data from the source and, if necessary, modifying
its type and value.</li>
<li>The column identifier can be of type <code>String</code>, <code>Integer</code> or <code>Symbol</code>. By default,
the column header takes the value of the identifier, unless the optional
<code>header</code> parameter is used.</li>
<li>Columns are the same width.</li>
<li>We can see two types of row: header and body.</li>
<li>Columns of numbers are aligned to the right, and columns of text to the left, for
both headers and body.</li>
<li>Default borders use the classic <code>Ascii</code> type.</li>
</ul>
<h2><a id="borders" class="anchor" href="#borders">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Borders</h2>
<p>The Border structure lets you create frames around rows and columns, using
ascii and/or graphic characters.</p>
<p>A set of predefined borders is available, including <code>Ascii</code>,
<code>ReducedAscii</code> and <code>Fancy</code>, but you can also define your own border
types (see API for details).</p>
<p>Default border type is <code>Ascii</code>, but to change a table's border type,
simply assign the desired definition to the <code>border</code> parameter when
initializing the table. So, for example, to set the <code>ReducedAscii</code>
border type, you can do:</p>
<pre><code class="language-crystal">table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>],
  border: <span class="t">Tablo</span><span class="t">::</span><span class="t">Border</span>.new(<span class="t">Tablo</span><span class="t">::</span><span class="t">Border</span><span class="t">::</span><span class="t">PreSet</span><span class="t">::</span><span class="t">ReducedAscii</span>)) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span></code></pre>
<p>or even, more simply:</p>
<pre><code class="language-crystal">table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>],
  border: <span class="t">Tablo</span><span class="t">::</span><span class="t">Border</span>.new(<span class="n">:reduced_ascii</span>)) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span></code></pre>
<pre><code class="language-text">-------------- -------------- --------------
       itself         Double   String
-------------- -------------- --------------
            1              2   A
            2              4   BB
            3              6   CCC
-------------- -------------- --------------</code></pre>
<h2><a id="row-types" class="anchor" href="#row-types">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Row types</h2>
<h3><a id="header-and-body" class="anchor" href="#header-and-body">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Header and Body</h3>
<p>The Header and Body data row types form the basis of table formatting. Other
types can be optionally added to establish the final layout: the Group row
type and Heading row types (Title, SubTitle and Footer).</p>
<h3><a id="group" class="anchor" href="#group">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Group</h3>
<p>Adjacent columns can share a common header, above the column headers
themselves. This common header constitutes a Group row type.</p>
<p>To create a Group row, simply define a common header after each set of
adjacent columns to be grouped.</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>]) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="s">&quot;itself&quot;</span>, <span class="o">&amp;</span>.itself)
  t.add_column(<span class="n">2</span>, header: <span class="s">&quot;Double&quot;</span>) {<span class="o">|</span>n<span class="o">|</span> n <span class="o">*</span> <span class="n">2</span>}
  t.add_group(<span class="s">&quot;Numbers&quot;</span>)
  t.add_column(<span class="n">:column_3</span>, header: <span class="s">&quot;String&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> (<span class="s">&#39;@&#39;</span>.ord <span class="o">+</span> n).chr.to_s <span class="o">*</span> n }
  t.add_group(<span class="s">&quot;Text&quot;</span>)
<span class="k">end</span>
puts table</code></pre>
<p>Output:</p>
<pre><code class="language-crystal">+-----------------------------+--------------+
|           Numbers           |     Text     |
+--------------+--------------+--------------+
|       itself |       Double | String       |
+--------------+--------------+--------------+
|            1 |            2 | A            |
|            2 |            4 | BB           |
|            3 |            6 | CCC          |
+--------------+--------------+--------------+</code></pre>
<p>By default, Group headers are centered, but their alignment can be modified
globally at table initialization time with the <code>group_alignment</code> parameter,
or locally for a given group with the <code>alignment</code> parameter.</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>

table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>],
  group_alignment: <span class="t">Tablo</span><span class="t">::</span><span class="t">Justify</span><span class="t">::</span><span class="t">Left</span>) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="s">&quot;itself&quot;</span>, <span class="o">&amp;</span>.itself)
  t.add_column(<span class="n">2</span>, header: <span class="s">&quot;Double&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n <span class="o">*</span> <span class="n">2</span> }
  t.add_group(<span class="s">&quot;Numbers&quot;</span>)
  t.add_column(<span class="n">:column_3</span>, header: <span class="s">&quot;String&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> (<span class="s">&#39;@&#39;</span>.ord <span class="o">+</span> n).chr.to_s <span class="o">*</span> n }
  t.add_group(<span class="s">&quot;Text&quot;</span>)
<span class="k">end</span>
puts table</code></pre>
<p>Output:</p>
<pre><code class="language-crystal">...
<span class="o">|</span> <span class="t">Numbers</span>                     <span class="o">|</span> <span class="t">Text</span>         <span class="o">|</span>
...</code></pre>
<p>or</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>]) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="s">&quot;itself&quot;</span>, <span class="o">&amp;</span>.itself)
  t.add_column(<span class="n">2</span>, header: <span class="s">&quot;Double&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n <span class="o">*</span> <span class="n">2</span> }
  t.add_group(<span class="s">&quot;Numbers&quot;</span>)
  t.add_column(<span class="n">:column_3</span>, header: <span class="s">&quot;String&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> (<span class="s">&#39;@&#39;</span>.ord <span class="o">+</span> n).chr.to_s <span class="o">*</span> n }
  t.add_group(<span class="s">&quot;Text&quot;</span>, alignment: <span class="t">Tablo</span><span class="t">::</span><span class="t">Justify</span><span class="t">::</span><span class="t">Left</span>)
<span class="k">end</span>
puts table</code></pre>
<p>Output:</p>
<pre><code class="language-crystal">...
<span class="o">|</span>           <span class="t">Numbers</span>           <span class="o">|</span> <span class="t">Text</span>         <span class="o">|</span>
...</code></pre>
<p>Note that the group header can be empty, and that an empty group header is
automatically created if the last column group is not specified.</p>
<p>Group and header are intimately linked and only separated by a horizontal
line. For custom rendering, this line can be omitted by setting the Table
<code>omit_group_header_rule</code> parameter to <code>true</code>.</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>

table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>],
        omit_group_header_rule: <span class="n">true</span>) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
    t.add_column(<span class="s">&quot;itself&quot;</span>, <span class="o">&amp;</span>.itself)
    t.add_column(<span class="n">2</span>, header: <span class="s">&quot;Double&quot;</span>) {<span class="o">|</span>n<span class="o">|</span> n <span class="o">*</span> <span class="n">2</span>}
    t.add_group(<span class="s">&quot;Numbers&quot;</span>)
    t.add_column(<span class="n">:column_3</span>, header: <span class="s">&quot;String&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> (<span class="s">&#39;@&#39;</span>.ord <span class="o">+</span> n).chr.to_s <span class="o">*</span> n }
    t.add_column(<span class="n">:column_4</span>, header: <span class="s">&quot;Boolean&quot;</span>) {<span class="o">|</span>n<span class="o">|</span> n.even?}
    t.add_group(<span class="s">&quot;Other data types&quot;</span>)
<span class="k">end</span>

puts table</code></pre>
<p>Output:</p>
<pre><code class="language-crystal">+-----------------------------+-----------------------------+
|           Numbers           |       Other data types      |
|       itself |       Double | String       |    Boolean   |
+--------------+--------------+--------------+--------------+
|            1 |            2 | A            |     false    |
|            2 |            4 | BB           |     true     |
|            3 |            6 | CCC          |     false    |
+--------------+--------------+--------------+--------------+</code></pre>
<h3><a id="headings" class="anchor" href="#headings">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Headings</h3>
<p>A formatted table can optionally include a title, subtitle and footer. Each of
these elements is of type Heading (see API).</p>
<p>By default, when the table is initialized, their value is <code>nil</code>, so nothing is
displayed.</p>
<p>To display a title (or subtitle or footer), simply specify its value when
initializing the table.</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>],
  title: <span class="t">Tablo</span><span class="t">::</span><span class="t">Heading</span>.new(<span class="s">&quot;Data types alignment&quot;</span>)) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="s">&quot;itself&quot;</span>, <span class="o">&amp;</span>.itself)
  t.add_column(<span class="n">2</span>, header: <span class="s">&quot;Double&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n <span class="o">*</span> <span class="n">2</span> }
  t.add_group(<span class="s">&quot;Numbers&quot;</span>)
  t.add_column(<span class="n">:column_3</span>, header: <span class="s">&quot;String&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> (<span class="s">&#39;@&#39;</span>.ord <span class="o">+</span> n).chr.to_s <span class="o">*</span> n }
  t.add_column(<span class="n">:column_4</span>, header: <span class="s">&quot;Boolean&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n.even? }
  t.add_group(<span class="s">&quot;Other data types&quot;</span>)
<span class="k">end</span>
puts table</code></pre>
<p>Output:</p>
<pre><code class="language-crystal">                     Data types alignment
+-----------------------------+-----------------------------+
|           Numbers           |       Other data types      |
+--------------+--------------+--------------+--------------+
|       itself |       Double | String       |    Boolean   |
+--------------+--------------+--------------+--------------+
|            1 |            2 | A            |     false    |
|            2 |            4 | BB           |     true     |
|            3 |            6 | CCC          |     false    |
+--------------+--------------+--------------+--------------+</code></pre>
<p>These elements can also be framed, possibly with line breaks before and after
(defined in the <code>Heading::Frame</code> struct initializer as <code>line_breaks_before</code> and
<code>line_breaks_after</code> with a default value of 0).</p>
<p>The number of line breaks between adjacent elements is equal to the highest
value between the current element's <code>line_breaks_after</code> and the next element's
<code>line_breaks_before</code>.</p>
<pre><code class="language-crystal">table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>],
  title: <span class="t">Tablo</span><span class="t">::</span><span class="t">Heading</span>.new(<span class="s">&quot;Data types alignment&quot;</span>,
    framed: <span class="n">true</span>, line_breaks_before: <span class="n">0</span>, line_breaks_after: <span class="n">2</span>)) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  ...</code></pre>
<p>Output:</p>
<pre><code class="language-crystal">+-----------------------------------------------------------+
|                    Data types alignment                   |
+-----------------------------------------------------------+

+-----------------------------+-----------------------------+
|           Numbers           |       Other data types      |
+--------------+--------------+--------------+--------------+
|       itself |       Double | String       |    Boolean   |
+--------------+--------------+--------------+--------------+
|            1 |            2 | A            |     false    |
|            2 |            4 | BB           |     true     |
|            3 |            6 | CCC          |     false    |
+--------------+--------------+--------------+--------------+</code></pre>
<p>To sum up, we have 6 types of data rows :</p>
<ol>
<li>Title : Optional display </br></li>
<li>SubTitle : Optional display </br></li>
<li>Group : Optional display </br></li>
<li>Header : Always displayed, unless <code>header_frequency</code> is <code>nil</code> or <code>masked_headers</code> is <code>true</code> </br></li>
<li>Body : Always displayed </br></li>
<li>Footer : Optional display</li>
</ol>
<h2><a id="rules" class="anchor" href="#rules">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Rules</h2>
<p>Between the different types of data rows, there are also different types
of separation rules, whose format varies according to the types of rows
they separate.</p>
<p>In the case of framed rows, for example, there may be a single
separating rule, making the rows linked, or on the contrary, there may
first be a closing rule for the top row, possibly followed by line
breaks before the opening rule for the bottom row.</p>
<p>These horizontal rules are formatted by the <code>horizontal_rule</code> method of class
Border.</p>
<h2><a id="display-frequency-and-repeated-title" class="anchor" href="#display-frequency-and-repeated-title">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Display frequency and repeated title</h2>
<p>An important parameter in table initialization is <code>header_frequency:</code></p>
<ul>
<li>By default, it is set to 0, i.e. rows of data other than body are displayed
only once, at the beginning for titles and headers, at the end for the footer.</li>
</ul>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>],
  <span class="c"># header_frequency: 0,</span>
  title: <span class="t">Tablo</span><span class="t">::</span><span class="t">Heading</span>.new(<span class="s">&quot;Data types alignment&quot;</span>,
    framed: <span class="n">true</span>, line_breaks_before: <span class="n">0</span>, line_breaks_after: <span class="n">2</span>),
  subtitle: <span class="t">Tablo</span><span class="t">::</span><span class="t">Heading</span>.new(<span class="s">&quot;Only Booleans are centered by default&quot;</span>),
  footer: <span class="t">Tablo</span><span class="t">::</span><span class="t">Heading</span>.new(<span class="s">&quot;End of page&quot;</span>)) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="s">&quot;itself&quot;</span>, <span class="o">&amp;</span>.itself)
  t.add_column(<span class="n">2</span>, header: <span class="s">&quot;Double&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n <span class="o">*</span> <span class="n">2</span> }
  t.add_group(<span class="s">&quot;Numbers&quot;</span>)
  t.add_column(<span class="n">:column_3</span>, header: <span class="s">&quot;String&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> (<span class="s">&#39;@&#39;</span>.ord <span class="o">+</span> n).chr.to_s <span class="o">*</span> n }
  t.add_column(<span class="n">:column_4</span>, header: <span class="s">&quot;Boolean&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n.even? }
  t.add_group(<span class="s">&quot;Other data types&quot;</span>)
<span class="k">end</span>
puts table</code></pre>
<p>Output:</p>
<pre><code class="language-crystal">+-----------------------------------------------------------+
|                    Data types alignment                   |
+-----------------------------------------------------------+

            Only Booleans are centered by default
+-----------------------------+-----------------------------+
|           Numbers           |       Other data types      |
+--------------+--------------+--------------+--------------+
|       itself |       Double | String       |    Boolean   |
+--------------+--------------+--------------+--------------+
|            1 |            2 | A            |     false    |
|            2 |            4 | BB           |     true     |
|            3 |            6 | CCC          |     false    |
+--------------+--------------+--------------+--------------+
                         End of page  ``</code></pre>
<ul>
<li>If set to <code>nil</code>, only body rows are displayed.</li>
</ul>
<pre><code class="language-crystal">table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>],
        header_frequency: <span class="n">nil</span>,
...</code></pre>
<p>Output:</p>
<pre><code class="language-crystal">+--------------+--------------+--------------+--------------+
|            1 |            2 | A            |     false    |
|            2 |            4 | BB           |     true     |
|            3 |            6 | CCC          |     false    |
+--------------+--------------+--------------+--------------+</code></pre>
<ul>
<li>If set to <code>n</code> (positive), group or column headers are repeated every <code>n</code>
rows, as are footers, but titles and subtitles are not repeated.</li>
</ul>
<pre><code class="language-crystal">table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>],
        header_frequency: <span class="n">2</span>,
...</code></pre>
<p>Output:</p>
<pre><code class="language-crystal">+-----------------------------------------------------------+
|                    Data types alignment                   |
+-----------------------------------------------------------+

            Only Booleans are centered by default
+-----------------------------+-----------------------------+
|           Numbers           |       Other data types      |
+--------------+--------------+--------------+--------------+
|       itself |       Double | String       |    Boolean   |
+--------------+--------------+--------------+--------------+
|            1 |            2 | A            |     false    |
|            2 |            4 | BB           |     true     |
+--------------+--------------+--------------+--------------+
                         End of page
+-----------------------------+-----------------------------+
|           Numbers           |       Other data types      |
+--------------+--------------+--------------+--------------+
|       itself |       Double | String       |    Boolean   |
+--------------+--------------+--------------+--------------+
|            3 |            6 | CCC          |     false    |
|              |              |              |              |
+--------------+--------------+--------------+--------------+
                         End of page ``</code></pre>
<p>However, if the title <code>repeated</code> parameter is set to <code>true</code>, we obtain title and
subtitle repetition.</p>
<pre><code class="language-crystal">table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>],
  header_frequency: <span class="n">2</span>,
  title: <span class="t">Tablo</span><span class="t">::</span><span class="t">Heading</span>.new(<span class="s">&quot;Data types alignment&quot;</span>,
    framed: <span class="n">true</span>, line_breaks_before: <span class="n">0</span>, line_breaks_after: <span class="n">2</span>, repeated: <span class="n">true</span>),
...</code></pre>
<p>Output:</p>
<pre><code class="language-crystal">+-----------------------------------------------------------+
|                    Data types alignment                   |
+-----------------------------------------------------------+

            Only Booleans are centered by default
+-----------------------------+-----------------------------+
|           Numbers           |       Other data types      |
+--------------+--------------+--------------+--------------+
|       itself |       Double | String       |    Boolean   |
+--------------+--------------+--------------+--------------+
|            1 |            2 | A            |     false    |
|            2 |            4 | BB           |     true     |
+--------------+--------------+--------------+--------------+
                         End of page
+-----------------------------------------------------------+
|                    Data types alignment                   |
+-----------------------------------------------------------+

            Only Booleans are centered by default
+-----------------------------+-----------------------------+
|           Numbers           |       Other data types      |
+--------------+--------------+--------------+--------------+
|       itself |       Double | String       |    Boolean   |
+--------------+--------------+--------------+--------------+
|            3 |            6 | CCC          |     false    |
|              |              |              |              |
+--------------+--------------+--------------+--------------+
                         End of page</code></pre>
<h2><a id="extracting-formatting-styling" class="anchor" href="#extracting-formatting-styling">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Extracting - Formatting - Styling</h2>
<p>At the heart of Tablo's operations is the Cell, a data structure containing
all the elements required for display.</p>
<p>A cell, whether fed by data extracted from the source or directly from the
code, can span several lines. Even if it initially occupies a single line,
reducing the column width can result in a cell being displayed over several
lines.</p>
<p>Inside a cell, you can limit the number of lines displayed by using the
<code>header_wrap</code> or <code>body_wrap</code> parameters when initializing the table
(These 2 parameters are global to the table, and cannot be set on
individual columns). If the whole cell content cannot be displayed due
to this restriction, a special character (tilde by default) is inserted
in the right-hand padding area of the last line of the cell (unless
right padding is set to 0 for the column).</p>
<p>Note here the use of the <code>row_divider_frequency</code> parameter to separate body
rows</p>
<p>Note also in this example the direct use of a character string for
border elements, with the last 4 characters defining the separating
lines between Heading(title, subtitle and footer), Group, Header and
Body rows respectively.</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="s">&quot;First\nrow&quot;</span>, <span class="s">&quot;Second row\nextending\nover\nfour lines&quot;</span>, <span class="s">&quot;Last row&quot;</span>],
  title: <span class="t">Tablo</span><span class="t">::</span><span class="t">Heading</span>.new(<span class="s">&quot;Title&quot;</span>, framed: <span class="n">true</span>),
  subtitle: <span class="t">Tablo</span><span class="t">::</span><span class="t">Heading</span>.new(<span class="s">&quot;SubTitle&quot;</span>, framed: <span class="n">true</span>),
  border: <span class="t">Tablo</span><span class="t">::</span><span class="t">Border</span>.new(<span class="s">&quot;+++++++++|||*=-.&quot;</span>),
  header_wrap: <span class="n">4</span>,
  body_wrap: <span class="n">3</span>,
  row_divider_frequency: <span class="n">1</span>) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="s">&quot;Column\nheader\nextending\nover\n5 lines&quot;</span>, <span class="o">&amp;</span>.itself)
  t.add_group(<span class="s">&quot;Group header&quot;</span>)
<span class="k">end</span>
puts table</code></pre>
<p>Output:</p>
<pre><code class="language-crystal">+**************+
|     Title    |
+**************+
|   SubTitle   |
+**************+
| Group header |
+==============+
| Column       |
| header       |
| extending    |
| over        ~|
+--------------+
| First        |
| row          |
+..............+
| Second row   |
| extending    |
| over        ~|
+..............+
| Last row     |
+**************+</code></pre>
<p>In addition, to have greater control over the line break, we can use the
<code>wrap_mode</code> parameter to choose between <code>Rune</code> (roughly equivalent to
a character) and <code>Word</code> (default) when cutting a line.</p>
<p>To use Tablo with non-Romanic languages, it is mandatory to use the
<code>naqviz/uni_char_width</code> shard so that the width of each grapheme is correctly
managed, without impacting alignment.</p>
<p>Here is an example of bad formatting when this shard is omitted :</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="s">&quot;Crystal\nクリスタル&quot;</span>],
  header_frequency: <span class="n">nil</span>) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="n">1</span>, <span class="o">&amp;</span>.itself)
<span class="k">end</span>
puts table</code></pre>
<p>Output (image):</p>
 <p> <img src="assets/images/tutorial_asian_bad.png"> </p>
<p>To correct this, you need to:</p>
<ul>
<li>Add the dependencies to your shard.yml:</li>
</ul>
<pre><code class="language-yaml">dependencies:
  tablo:
    github: hutou/tablo
  uniwidth:
    github: naqvis/uni_char_width</code></pre>
<ul>
<li>Run <code>shards install</code></li>
<li>And insert the lines</li>
</ul>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
<span class="k">require</span> <span class="s">&quot;uniwidth&quot;</span></code></pre>
<p>at the beginning of your app, like this :</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
<span class="k">require</span> <span class="s">&quot;uniwidth&quot;</span>
table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="s">&quot;Crystal\nクリスタル&quot;</span>],
  header_frequency: <span class="n">nil</span>) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="n">1</span>, <span class="o">&amp;</span>.itself)
<span class="k">end</span>
puts table</code></pre>
<p>Output (image):</p>
 <p> <img src="assets/images/tutorial_asian_good.png"> </p>
<h3><a id="extracting" class="anchor" href="#extracting">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Extracting</h3>
<p>The cell <code>value</code> attribute contains the raw data.</p>
<p>If directly given as argument to Headings or Group, the cell is a <code>TextCell</code>
as it is not related to source data.</p>
<p>If extracted from the source (body rows), the cell is of type <code>DataCell</code>, and
the corresponding column header is also a <code>DataCell</code> (as it depends on the
type of body <code>value</code> for alignment).</p>
<p>The <code>coords</code> attribute, specific to the <code>DataCell</code> type, provides access to
the cell's coordinates (<code>row_index</code> and <code>column_index</code>), as well as the
<code>body_value</code>. This information is used to activate conditional formatting and
styling.</p>
<pre><code class="language-crystal"><span class="k">struct</span> <span class="t">Cell</span><span class="t">::</span><span class="t">Data</span><span class="t">::</span><span class="t">Coords</span>
getter body_value, row_index, column_index
    <span class="k">def</span> <span class="m">initialize</span>(@body_value : <span class="t">CellType</span>, @row_index : <span class="t">Int32</span>, @column_index : <span class="t">Int32</span>)
    <span class="k">end</span>
<span class="k">end</span></code></pre>
<p>The type of <code>value</code> is <code><a href="Tablo/CellType.html">Tablo::CellType</a></code>, which is simply defined as an empty
module restriction type:</p>
<pre><code class="language-crystal"><span class="k">module</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>
<span class="k">end</span></code></pre>
<p>This module is already included in most of Crystal's scalar types. To
use a scalar type (not or less commonly used) or a stdlib or
user-defined class or struct, it is mandatory to include it by reopening
the class or struct.</p>
<p>For example, to allow a cell value to contain an array, we could do :</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
<span class="k">class</span> <span class="t">Array</span>
  <span class="k">include</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>
<span class="k">end</span>
table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([[<span class="n">1</span>, <span class="n">2</span>], [<span class="n">3</span>, <span class="n">4</span>]]) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="s">&quot;itself&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n }
<span class="k">end</span>
puts table</code></pre>
<p>Output:</p>
<pre><code class="language-crystal">+--------------+
| itself       |
+--------------+
| [1, 2]       |
| [3, 4]       |
+--------------+</code></pre>
<h3><a id="formatting" class="anchor" href="#formatting">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Formatting</h3>
<p>Formatting consists in applying a transformation to the raw data (the <code>value</code>)
to obtain a character string ready to be displayed. The simplest
transformation (which is also the one applied by default) is simply a call to
the <code>to_s</code> method.</p>
<p>Using a <code>Proc</code> <code>formatter</code> allows you to customize formatting in a variety of
ways, from using <code>sprintf</code> formatting strings for numeric values to various
<code>String</code> methods for text and specific <code><a href="Tablo/Functions.html">Tablo::Functions</a></code> methods for both.</p>
<p>A formatter <code>Proc</code> can take four forms : the first two apply equally to TextCell
and DataCell and are applied unconditionally on <code>value</code>.</p>
<p>The first form expects one parameter (<code>value</code>) and the second two: <code>value</code> and
<code>width</code> (column width).</p>
<p>Here is an example of the first form:</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>]) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="s">&quot;itself&quot;</span>, <span class="o">&amp;</span>.itself)
  t.add_column(<span class="n">2</span>, header: <span class="s">&quot;Double&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n <span class="o">*</span> <span class="n">2</span> }
  t.add_column(<span class="n">3</span>, header: <span class="s">&quot;Float&quot;</span>,
    header_formatter: <span class="o">-&gt;</span>(value : <span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>) { value.<span class="k">as</span>(<span class="t">String</span>).upcase },
    body_formatter: <span class="o">-&gt;</span>(value : <span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>) {
      <span class="s">&quot;%.3f&quot;</span> <span class="o">%</span> value.<span class="k">as</span>(<span class="t">Float</span>)
    }) { <span class="o">|</span>n<span class="o">|</span> n <span class="o">**</span> <span class="n">0.5</span> }
<span class="k">end</span>
puts table</code></pre>
<p>Output:</p>
<pre><code class="language-crystal">+--------------+--------------+--------------+
|       itself |       Double |        FLOAT |   &lt;1&gt;
+--------------+--------------+--------------+
|            1 |            2 |        1.000 |
|            2 |            4 |        1.414 |
|            3 |            6 |        1.732 |
+--------------+--------------+--------------+</code></pre>
<p>&lt;1&gt; Note that the FLOAT column is aligned to the right, as its alignment is
governed by the type of <code>value</code>, which is a float.</p>
<p>If the formatting were done directly at the data extraction level, <code>value</code>
would be of type <code>String</code> and column would be aligned to the left.</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>]) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="s">&quot;itself&quot;</span>, <span class="o">&amp;</span>.itself)
  t.add_column(<span class="n">2</span>, header: <span class="s">&quot;Double&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n <span class="o">*</span> <span class="n">2</span> }
  t.add_column(<span class="n">3</span>, header: <span class="s">&quot;Float&quot;</span>,
    header_formatter: <span class="o">-&gt;</span>(value : <span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>) {
    value.<span class="k">as</span>(<span class="t">String</span>).upcase }) { <span class="o">|</span>n<span class="o">|</span> <span class="s">&quot;%.3f&quot;</span> <span class="o">%</span> (n <span class="o">**</span> <span class="n">0.5</span>)
  }
<span class="k">end</span>
puts table</code></pre>
<p>Output:</p>
<pre><code class="language-crystal">+--------------+--------------+--------------+
|       itself |       Double | FLOAT        |
+--------------+--------------+--------------+
|            1 |            2 | 1.000        |
|            2 |            4 | 1.414        |
|            3 |            6 | 1.732        |
+--------------+--------------+--------------+</code></pre>
<p>To illustrate the 2nd form, we will use the <code>Tablo::Functions.stretch</code> method,
which can be useful for groups or headings.</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>]) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="s">&quot;itself&quot;</span>, <span class="o">&amp;</span>.itself)
  t.add_column(<span class="n">2</span>, header: <span class="s">&quot;Double&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n <span class="o">*</span> <span class="n">2</span> }
  t.add_group(<span class="s">&quot;Numbers&quot;</span>,
    formatter: <span class="o">-&gt;</span>(value : <span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>, width : <span class="t">Int32</span>) {
      <span class="t">Tablo</span><span class="t">::</span><span class="t">Functions</span>.stretch(value.<span class="k">as</span>(<span class="t">String</span>), width, <span class="s">&#39; &#39;</span>)
    })
  t.add_column(<span class="n">:column_3</span>, header: <span class="s">&quot;String&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> (<span class="s">&#39;@&#39;</span>.ord <span class="o">+</span> n).chr.to_s <span class="o">*</span> n }
  t.add_column(<span class="n">:column_4</span>, header: <span class="s">&quot;Boolean&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n.even? }
  t.add_group(<span class="s">&quot;Other data types&quot;</span>)
<span class="k">end</span>
puts table</code></pre>
<p>Output:</p>
<pre><code class="language-crystal">+-----------------------------+-----------------------------+
|  N   u   m   b   e   r   s  |       Other data types      |
+--------------+--------------+--------------+--------------+
|       itself |       Double | String       |    Boolean   |
+--------------+--------------+--------------+--------------+
|            1 |            2 | A            |     false    |
|            2 |            4 | BB           |     true     |
|            3 |            6 | CCC          |     false    |
+--------------+--------------+--------------+--------------+</code></pre>
<p>Form 3 and form 4 apply only on DataCell cell types, as they use the
<code>coords</code> parameter to conditionnally format the <code>value</code>.</p>
<p>Here is an exemple of form 3 with another method from <code><a href="Tablo/Functions.html">Tablo::Functions</a></code>, which uses
the <code>column_index</code> as formatting condition.</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">-30.00001</span>, <span class="n">-3.14159</span>, <span class="n">0.0</span>, <span class="n">1.470001</span>, <span class="n">5.78707</span>, <span class="n">10.0</span>],
  body_formatter: <span class="o">-&gt;</span>(value : <span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>, coords : <span class="t">Tablo</span><span class="t">::</span><span class="t">Cell</span><span class="t">::</span><span class="t">Data</span><span class="t">::</span><span class="t">Coords</span>) {
    <span class="k">case</span> coords.column_index
    <span class="k">when</span> <span class="n">1</span> <span class="k">then</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Functions</span>.fp_align(value.<span class="k">as</span>(<span class="t">Float</span>), <span class="n">4</span>, <span class="t">Tablo</span><span class="t">::</span><span class="t">Functions</span><span class="t">::</span><span class="t">FPAlign</span><span class="t">::</span><span class="t">Blank</span>)
    <span class="k">when</span> <span class="n">2</span> <span class="k">then</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Functions</span>.fp_align(value.<span class="k">as</span>(<span class="t">Float</span>), <span class="n">4</span>, <span class="t">Tablo</span><span class="t">::</span><span class="t">Functions</span><span class="t">::</span><span class="t">FPAlign</span><span class="t">::</span><span class="t">NoDot</span>)
    <span class="k">when</span> <span class="n">3</span> <span class="k">then</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Functions</span>.fp_align(value.<span class="k">as</span>(<span class="t">Float</span>), <span class="n">4</span>, <span class="t">Tablo</span><span class="t">::</span><span class="t">Functions</span><span class="t">::</span><span class="t">FPAlign</span><span class="t">::</span><span class="t">DotOnly</span>)
    <span class="k">when</span> <span class="n">4</span> <span class="k">then</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Functions</span>.fp_align(value.<span class="k">as</span>(<span class="t">Float</span>), <span class="n">4</span>, <span class="t">Tablo</span><span class="t">::</span><span class="t">Functions</span><span class="t">::</span><span class="t">FPAlign</span><span class="t">::</span><span class="t">DotZero</span>)
    <span class="k">else</span>        value.<span class="k">as</span>(<span class="t">Float</span>).to_s
    <span class="k">end</span>
  }) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="s">&quot;itself&quot;</span>, <span class="o">&amp;</span>.itself)
  t.add_column(<span class="s">&quot;1 - Blank&quot;</span>, <span class="o">&amp;</span>.itself)
  t.add_column(<span class="s">&quot;2 - NoDot&quot;</span>, <span class="o">&amp;</span>.itself)
  t.add_column(<span class="s">&quot;3 - DotOnly&quot;</span>, <span class="o">&amp;</span>.itself)
  t.add_column(<span class="s">&quot;4 - DotZero&quot;</span>, <span class="o">&amp;</span>.itself)
<span class="k">end</span>
puts table</code></pre>
<p>Output:</p>
<pre><code class="language-crystal">+--------------+--------------+--------------+--------------+--------------+
|       itself |    1 - Blank |    2 - NoDot |  3 - DotOnly |  4 - DotZero |
+--------------+--------------+--------------+--------------+--------------+
|    -30.00001 |     -30      |     -30      |     -30.     |     -30.0    |
|     -3.14159 |      -3.1416 |      -3.1416 |      -3.1416 |      -3.1416 |
|          0.0 |              |       0      |       0.     |       0.0    |
|     1.470001 |       1.47   |       1.47   |       1.47   |       1.47   |
|      5.78707 |       5.7871 |       5.7871 |       5.7871 |       5.7871 |
|         10.0 |      10      |      10      |      10.     |      10.0    |
+--------------+--------------+--------------+--------------+--------------+</code></pre>
<p>Incidentally, this last example displays all the formatting possibilities of
the <code>Tablo::Functions.fp_align</code> method.</p>
<p>Compared to the third form, form 4 also allows the use of the width value.</p>
<p>Just for fun, here is a slightly contrived example:</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>, <span class="n">4</span>, <span class="n">5</span>, <span class="n">6</span>, <span class="n">7</span>, <span class="n">8</span>, <span class="n">9</span>]) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="n">:column_3</span>, header: <span class="s">&quot;King&#39;s crown&quot;</span>, width: <span class="n">20</span>,
    header_alignment: <span class="t">Tablo</span><span class="t">::</span><span class="t">Justify</span><span class="t">::</span><span class="t">Center</span>,
    body_alignment: <span class="t">Tablo</span><span class="t">::</span><span class="t">Justify</span><span class="t">::</span><span class="t">Center</span>,
    body_formatter: <span class="o">-&gt;</span>(value : <span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>, coords : <span class="t">Tablo</span><span class="t">::</span><span class="t">Cell</span><span class="t">::</span><span class="t">Data</span><span class="t">::</span><span class="t">Coords</span>, width : <span class="t">Int32</span>) {
      <span class="t">Tablo</span><span class="t">::</span><span class="t">Functions</span>.stretch(value.<span class="k">as</span>(<span class="t">String</span>), width, <span class="s">&#39; &#39;</span>)
    }
  ) { <span class="o">|</span>n<span class="o">|</span> (<span class="s">&#39;@&#39;</span>.ord <span class="o">+</span> n).chr.to_s <span class="o">*</span> n }
<span class="k">end</span>
puts table</code></pre>
<p>Output:</p>
<pre><code class="language-crystal">+----------------------+
|     King&#39;s crown     |
+----------------------+
|           A          |
| B                  B |
|  C        C        C |
|  D     D     D     D |
|   E   E   E   E   E  |
|   F  F  F  F  F  F   |
|  G  G  G  G  G  G  G |
|    H H H H H H H H   |
|   I I I I I I I I I  |
+----------------------+</code></pre>
<p>Overview of the 4 different forms of formatter procs:</p>
<ul>
<li>1st form: <code>value</code> : <code><a href="Tablo/CellType.html">Tablo::CellType</a></code> <br />used by: <code>TextCell</code> or <code>DataCell</code></li>
<li>2nd form: <code>value</code> : <code><a href="Tablo/CellType.html">Tablo::CellType</a></code>, <code>width</code> : <code>Int32</code> <br />used by: <code>TextCell</code> or <code>DataCell</code></li>
<li>3rd form: <code>value</code> : <code><a href="Tablo/CellType.html">Tablo::CellType</a></code>, <code>coords</code> : <code><a href="Tablo/Cell/Data/Coords.html">Tablo::Cell::Data::Coords</a></code> <br />used by: <code>DataCell</code></li>
<li>4th form: <code>value</code> : <code><a href="Tablo/CellType.html">Tablo::CellType</a></code>, <code>coords</code> : <code><a href="Tablo/Cell/Data/Coords.html">Tablo::Cell::Data::Coords</a></code>, <br /><code>width</code> : <code>Int32</code> used by: <code>DataCell</code></li>
</ul>
<h3><a id="styling" class="anchor" href="#styling">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Styling</h3>
<p>When it comes to terminal styling, the possibilities are limited, especially
as they depend on the terminal's capabilities. There are therefore
2 complementary ways of proceeding:</p>
<ul>
<li>Play with the mode (underlined, bold, italic...)</li>
<li>Use color</li>
</ul>
<p>This can be done using ANSI code sequences, or preferably, using the
<code>colorize</code> module of the standard library.</p>
<p>In this section, we'll be using color, altered characters and graphic borders
with the Fancy border type. Output will therefore be presented as images,
so as to guarantee perfect rendering, whatever the medium used for display.</p>
<p>For styling, there are 5 forms of procs.</p>
<p>The first uses only the (formatted) content as a parameter, and therefore does not
allow conditional styling.</p>
<p>Let's look at a simple example, with yellow borders and blue headers.</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
<span class="k">require</span> <span class="s">&quot;colorize&quot;</span>
table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>],
  border: <span class="t">Tablo</span><span class="t">::</span><span class="t">Border</span>.new(<span class="n">:fancy</span>, styler: <span class="o">-&gt;</span>(border_char : <span class="t">String</span>) {
    border_char.colorize(<span class="n">:yellow</span>).to_s
  }),
  header_styler: <span class="o">-&gt;</span>(content : <span class="t">String</span>) { content.colorize(<span class="n">:blue</span>).to_s }) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="s">&quot;itself&quot;</span>, <span class="o">&amp;</span>.itself)
  t.add_column(<span class="n">2</span>, header: <span class="s">&quot;Double&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n <span class="o">*</span> <span class="n">2</span> }
  t.add_column(<span class="n">:column_3</span>, header: <span class="s">&quot;String&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> (<span class="s">&#39;@&#39;</span>.ord <span class="o">+</span> n).chr.to_s <span class="o">*</span> n }
  t.add_column(<span class="n">:column_4</span>, header: <span class="s">&quot;Boolean&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n.even? }
<span class="k">end</span>
puts table</code></pre>
<p>Output:</p>
<p> <img src="assets/images/tutorial_styling_first_form.png"</p>
<p>Cool! Let's do now some conditional styling, painting in bold green all values
greater than 2 in all numeric columns and underlining the <code>true</code> boolean value
in fourth column: this is the third form of styling.
Just add, at the table level before <code>header_styler</code>, the following lines :</p>
<pre><code class="language-crystal">body_styler: <span class="o">-&gt;</span>(value : <span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>, content : <span class="t">String</span>) {
  <span class="k">case</span> value
  <span class="k">when</span> <span class="t">Int32</span>
    value <span class="o">&gt;</span> <span class="n">2</span> ? content.colorize.fore(<span class="n">:green</span>).mode(<span class="n">:bold</span>).to_s : content
  <span class="k">else</span>
    value <span class="o">==</span> <span class="n">true</span> ? content.colorize.mode(<span class="n">:underline</span>).to_s : content
  <span class="k">end</span>
},</code></pre>
<p>Output:</p>
<p><img src="assets/images/tutorial_styling_third_form.png"> </p>
<p>Let's end with a final example, with a black-and-white look: how do you
display rows alternately in black (with a bit of italics) and dark gray
to make them easier to read?</p>
<p>This would be the 4th form.</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
<span class="k">require</span> <span class="s">&quot;colorize&quot;</span>
table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>, <span class="n">2</span>, <span class="n">3</span>, <span class="n">4</span>, <span class="n">5</span>],
  title: <span class="t">Tablo</span><span class="t">::</span><span class="t">Heading</span>.new(<span class="s">&quot;My black and white fancy table&quot;</span>, framed: <span class="n">true</span>),
  footer: <span class="t">Tablo</span><span class="t">::</span><span class="t">Heading</span>.new(<span class="s">&quot;End of data&quot;</span>, framed: <span class="n">true</span>),
  border: <span class="t">Tablo</span><span class="t">::</span><span class="t">Border</span>.new(<span class="n">:fancy</span>, <span class="o">-&gt;</span>(border_char : <span class="t">String</span>) {
    border_char.colorize(<span class="n">:dark_gray</span>).to_s
  }),
  body_styler: <span class="o">-&gt;</span>(_value : <span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>, coords : <span class="t">Tablo</span><span class="t">::</span><span class="t">Cell</span><span class="t">::</span><span class="t">Data</span><span class="t">::</span><span class="t">Coords</span>, content : <span class="t">String</span>) {
    <span class="k">if</span> coords.row_index.even?
      <span class="s">&quot;\e[3m&quot;</span> <span class="o">+</span> content.colorize(<span class="n">:black</span>).to_s <span class="o">+</span> <span class="s">&quot;\e[0m&quot;</span>
    <span class="k">else</span>
      content.colorize.fore(<span class="n">:dark_gray</span>).to_s
    <span class="k">end</span>
  },
  header_styler: <span class="o">-&gt;</span>(content : <span class="t">String</span>) { content.colorize.mode(<span class="n">:bold</span>).to_s }) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="s">&quot;itself&quot;</span>, <span class="o">&amp;</span>.itself)
  t.add_column(<span class="n">2</span>, header: <span class="s">&quot;Double&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n <span class="o">*</span> <span class="n">2</span> }
  t.add_column(<span class="n">:column_3</span>, header: <span class="s">&quot;String&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> (<span class="s">&#39;@&#39;</span>.ord <span class="o">+</span> n).chr.to_s <span class="o">*</span> n }
<span class="k">end</span>
puts table</code></pre>
<p>Output:</p>
<p> <img src="assets/images/tutorial_styling_fourth_form.png"> </p>
<p><em><em>From version 1.10 onwards, Crystal <code>colorize</code> module does support italic
mode, and the use of ANSI sequences is given here simply as an
example.</em></em></p>
<p>Overview of the 5 different forms of styler procs:</p>
<ul>
<li>1st form: <code>(formatted) content</code> : <code>String</code> <br />used by: <code>Border</code>, <code>TextCell</code> or <code>DataCell</code></li>
<li>2nd form: <code>(formatted) content</code> : <code>String</code>, <code>line_index</code> : <code>Int32</code> <br /> used by: <code>TextCell</code></li>
<li>3rd form: <code>value</code> : <code><a href="Tablo/CellType.html">Tablo::CellType</a></code>, <code>(formatted) content</code> : <code>String</code> <br /> used by: <code>DataCell</code></li>
<li>4th form: <code>value</code> : <code><a href="Tablo/CellType.html">Tablo::CellType</a></code>, <code>coords</code> : <code><a href="Tablo/Cell/Data/Coords.html">Tablo::Cell::Data::Coords</a></code>, <br /> <code>(formatted) content</code> : <code>String</code> used by: <code>DataCell</code></li>
<li>5th form: <code>value</code> : <code><a href="Tablo/CellType.html">Tablo::CellType</a></code>, <code>coords</code> : <code><a href="Tablo/Cell/Data/Coords.html">Tablo::Cell::Data::Coords</a></code>, <br /> <code>(formatted) content</code> : <code>String</code>, <code>line_index</code> : <code>Int32</code> <br /> used by: <code>DataCell</code></li>
</ul>
<h2><a id="packing" class="anchor" href="#packing">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Packing</h2>
<p>In the previous examples, the notion of column width was used. For a better
understanding, the diagram below highlights the structure of a column.</p>
<p> <img src="assets/images/tutorial_column_layout.svg"> </p>
<p>As we saw at the start of this tutorial, by default, all columns have the same
width, i.e. 12 characters.</p>
<p>Of course, this value can be modified globally when initializing the table, or
individually when defining columns. The same applies to left and right
padding, as well as to the padding character (a space, by default).</p>
<p>The border width is 1 character maximum, but can be 0 (i.e. no border) if the
letter E is used in the border definition string.</p>
<p>The <code>pack</code> method is a welcome aid to table formatting. It accepts
3 parameters, all optional:</p>
<ul>
<li>
<p><code>width</code>: total width required for the formatted table. If no <code>width</code> is
given and if the value of parameter <code>Config.terminal_capped_width</code> is true,
the value of <code>width</code> is read from the size of the terminal, otherwise its
value is <code>nil</code> and in that case, only <code>packing_mode == AutoSized</code> has an
effect.</p>
</li>
<li>
<p><code>packing_mode</code> : column widths taken as starting point for resizing,
possible values are :</p>
<ul>
<li><code>Current</code> : resizing starts from columns current width</li>
<li><code>Initial</code> : current values are reset to their initial values, at column
definition time</li>
<li><code>AutoSized</code> : current values are set to their 'best fit'
values, <em>ie</em> they are automatically adapted to their largest content</li>
</ul>
</li>
<li>
<p><code>except</code> or <code>only</code> : (array of) column label(s) to be excluded from
being resized (<code>except</code>), or, on the contrary, to be selected for
packing (<code>only</code>).</p>
</li>
</ul>
<p>The following examples will illustrate the behaviour of the different
parameters values, starting from the 'standard' one, with all column widths to
their default value : 12 characters.</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
data <span class="o">=</span> [
  [<span class="n">1</span>, <span class="s">&quot;Box&quot;</span>, <span class="s">&quot;Orange&quot;</span>, <span class="s">&quot;Elephant&quot;</span>, <span class="s">&quot;Mont St Michel&quot;</span>],
]
table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new(data) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="s">&quot;Primes&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n[<span class="n">0</span>].<span class="k">as</span>(<span class="t">Int32</span>) }
  t.add_column(<span class="n">2</span>, header: <span class="s">&quot;Things&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n[<span class="n">1</span>].<span class="k">as</span>(<span class="t">String</span>) }
  t.add_column(<span class="n">:fruits</span>, header: <span class="s">&quot;Fruits&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n[<span class="n">2</span>].<span class="k">as</span>(<span class="t">String</span>) }
  t.add_column(<span class="n">3</span>, header: <span class="s">&quot;Animals&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n[<span class="n">3</span>].<span class="k">as</span>(<span class="t">String</span>) }
  t.add_column(<span class="s">&quot;Famous\nSites&quot;</span>) { <span class="o">|</span>n<span class="o">|</span> n[<span class="n">4</span>].<span class="k">as</span>(<span class="t">String</span>) }
<span class="k">end</span>
puts table
puts <span class="s">&quot;table width = </span><span class="i">#{</span>table.total_table_width<span class="i">}</span><span class="s">&quot;</span></code></pre>
<p>Table standard output, using default width values, without any packing:</p>
<pre><code class="language-crystal">puts table</code></pre>
<pre><code class="language-crystal">+--------------+--------------+--------------+--------------+--------------+
|       Primes | Things       | Fruits       | Animals      | Famous       |
|              |              |              |              | Sites        |
+--------------+--------------+--------------+--------------+--------------+
|            1 | Box          | Orange       | Elephant     | Mont St      |
|              |              |              |              | Michel       |
+--------------+--------------+--------------+--------------+--------------+
table width = 76</code></pre>
<p>Using default <code>pack</code> parameters (ie: none !), we get an optimal packing</p>
<pre><code class="language-crystal">puts table.pack</code></pre>
<pre><code class="language-crystal">+--------+--------+--------+----------+----------------+
| Primes | Things | Fruits | Animals  | Famous         |
|        |        |        |          | Sites          |
+--------+--------+--------+----------+----------------+
|      1 | Box    | Orange | Elephant | Mont St Michel |
+--------+--------+--------+----------+----------------+
table width = 56</code></pre>
<p>But using <code>pack</code> with same table width (56) on initial widths values gives
a significantly poorer result</p>
<pre><code class="language-crystal">puts table.pack(<span class="n">56</span>, packing_mode: <span class="t">Tablo</span><span class="t">::</span><span class="t">PackingMode</span><span class="t">::</span><span class="t">InitialWidths</span>)</code></pre>
<pre><code class="language-crystal">+----------+----------+----------+----------+----------+
|   Primes | Things   | Fruits   | Animals  | Famous   |
|          |          |          |          | Sites    |
+----------+----------+----------+----------+----------+
|        1 | Box      | Orange   | Elephant | Mont St  |
|          |          |          |          | Michel   |
+----------+----------+----------+----------+----------+
table width = 56</code></pre>
<p>This is due to the way Tablo reduces or increases column size. See the
description of the algorithm in the releated section for <code>Table.pack</code> in
API.</p>
<p>Using the <code>width</code> parameter, any table width can be obtained, by reducing or
increasing the width of each column progressively to reach the desired table
width</p>
<pre><code class="language-crystal">puts table.pack(<span class="n">30</span>)</code></pre>
<pre><code class="language-crystal">+-----+-----+-----+-----+----+
| Pri | Thi | Fru | Ani | Fa |
| mes | ngs | its | mal | mo |
|     |     |     | s   | us |
|     |     |     |     | Si |
|     |     |     |     | te |
|     |     |     |     | s  |
+-----+-----+-----+-----+----+
|   1 | Box | Ora | Ele | Mo |
|     |     | nge | pha | nt |
|     |     |     | nt  | St |
|     |     |     |     | Mi |
|     |     |     |     | el |
+-----+-----+-----+-----+----+
table width = 30</code></pre>
<p>or</p>
<pre><code class="language-crystal">puts table.pack(<span class="n">90</span>)</code></pre>
<pre><code class="language-crystal">+----------------+-----------------+-----------------+-----------------+-----------------+
|         Primes | Things          | Fruits          | Animals         | Famous          |
|                |                 |                 |                 | Sites           |
+----------------+-----------------+-----------------+-----------------+-----------------+
|              1 | Box             | Orange          | Elephant        | Mont St Michel  |
+----------------+-----------------+-----------------+-----------------+-----------------+
table width = 90</code></pre>
<p>There is, however, a limit to the reduction: each column must be able to
accommodate at least one character. Here, we're asking for a table width of
15, but the minimum size to respect this rule is 21!</p>
<pre><code class="language-crystal">puts table.pack(<span class="n">15</span>)</code></pre>
<pre><code class="language-crystal">+---+---+---+---+---+
| P | T | F | A | F |
| r | h | r | n | a |
| i | i | u | i | m |
| m | n | i | m | o |
| e | g | t | a | u |
| s | s | s | l | s |
|   |   |   | s | S |
|   |   |   |   | i |
|   |   |   |   | t |
|   |   |   |   | e |
|   |   |   |   | s |
+---+---+---+---+---+
| 1 | B | O | E | M |
|   | o | r | l | o |
|   | x | a | e | n |
|   |   | n | p | t |
|   |   | g | h | S |
|   |   | e | a | t |
|   |   |   | n | M |
|   |   |   | t | i |
|   |   |   |   | c |
|   |   |   |   | h |
|   |   |   |   | e |
|   |   |   |   | l |
+---+---+---+---+---+
table width = 21</code></pre>
<p>If, with the parameter <code>packing_mode == Startingwidths::AutoSized</code> by
default (set by <code>Config.packing_mode</code>), the <code>pack</code> method automatically
adapts the width of columns to their largest content (body or header) before
resizing, this requires you to go through the entire source dataset, which can
be costly in terms of performance in some cases.</p>
<p>This behavior can be avoided, but possibly with a loss of quality, by changing
the value of <code>packing_mode</code> to <code>Current</code> or <code>Initial</code>. In this case,
however, a value for <code>width</code> must be supplied, either directly or by reading
the terminal size, otherwise <code>pack</code> will become a non-operation.</p>
<p>Finally, using the <code>except</code> parameter, you can temporarily freeze the size of
one or more columns at their current value, so that they are excluded from
resizing.</p>
<pre><code class="language-crystal">table.pack
puts table.pack(<span class="n">100</span>,except: [<span class="n">2</span>, <span class="n">:fruits</span>])</code></pre>
<pre><code class="language-crystal">+----------------------+--------+--------+-----------------------+-----------------------+
|               Primes | Things | Fruits | Animals               | Famous                |
|                      |        |        |                       | Sites                 |
+----------------------+--------+--------+-----------------------+-----------------------+
|                    1 | Box    | Orange | Elephant              | Mont St Michel        |
+----------------------+--------+--------+-----------------------+-----------------------+
table width = 90</code></pre>
<p>The same effect could be obtained by the statements:</p>
<pre><code class="language-crystal">table.pack
puts table.pack(<span class="n">90</span>, only: [<span class="s">&quot;Primes&quot;</span>, <span class="n">3</span>, <span class="s">&quot;Famous\nSites&quot;</span>])</code></pre>
<p>Note that when a column is created using the <code>add_column</code> method, the width is
stored in 2 different attributes: the current value and the initial value
(never subsequently modified).</p>
<p>The <code>pack</code> method simply modifies the current column width value, and the
<code>to_s</code> method then takes care of the layout, and we can save the table in its
output layout in a string with :</p>
<pre><code class="language-crystal">formatted_table <span class="o">=</span> table.to_s</code></pre>
<p>It is therefore equivalent to write :</p>
<pre><code class="language-crystal">table.pack
puts table</code></pre>
<p>or</p>
<pre><code class="language-crystal">puts table.pack</code></pre>
<p>To sum up:</p>
<ul>
<li><code>table.pack</code>: <ul><li>Automatically adapts columns to their largest content</li>
<li>Modifies current values of column width</li></ul>
</li>
<li><code>table.pack(40)</code>: <ul> <li>Automatically adapts columns to their largest content</li>
<li>Modifies current values of column width</li>
<li>Reduces or increases column widths to meet total table size requirements</li></ul>
</li>
<li><code>table.pack(packing_mode: PackingMode::CurrentWidths)</code>: <ul><li>No-op</li></ul></li>
<li><code>table.pack(40, packing_mode: PackingMode::CurrentWidths)</code>: <ul>
<li>Reduces or increases column widths to meet total table size requirements</li></ul>
</li>
<li><code>table.pack(packing_mode: PackingMode::InitialWidths)</code>: <ul>
<li> Only resets current column values to their initial values, no packing is done</li></ul>
</li>
<li><code>table.pack(40, packing_mode: PackingMode::InitialWidths)</code>: <ul>
<li> Resets current column values to their initial values</li>
<li>Reduces or increases column widths to meet total table size requirements</li></ul>
</li>
</ul>
<h2><a id="summary" class="anchor" href="#summary">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Summary</h2>
<p>The Tablo library offers a basic yet useful summary method.</p>
<p>At present, it can be used to perform calculations on individual columns of data
and between columns.</p>
<p>Here's a rather complete and detailed example of how it works and what
it can do:</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
<span class="k">require</span> <span class="s">&quot;colorize&quot;</span>
<span class="k">require</span> <span class="s">&quot;big&quot;</span>

<span class="k">struct</span> <span class="t">BigDecimal</span>
  <span class="k">include</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>
<span class="k">end</span>

<span class="k">struct</span> <span class="t">InvoiceItem</span>
  getter product, quantity, price

  <span class="k">def</span> <span class="m">initialize</span>(@product : <span class="t">String</span>, @quantity : <span class="t">Int32</span>?, @price : <span class="t">BigDecimal</span>?)
  <span class="k">end</span>
<span class="k">end</span>

invoice <span class="o">=</span> [
  <span class="t">InvoiceItem</span>.new(<span class="s">&quot;Laptop&quot;</span>, <span class="n">3</span>, <span class="t">BigDecimal</span>.new(<span class="n">980</span>)),
  <span class="t">InvoiceItem</span>.new(<span class="s">&quot;Printer&quot;</span>, <span class="n">2</span>, <span class="t">BigDecimal</span>.new(<span class="n">154.99</span>)),
  <span class="t">InvoiceItem</span>.new(<span class="s">&quot;Router&quot;</span>, <span class="n">1</span>, <span class="t">BigDecimal</span>.new(<span class="n">99</span>)),
  <span class="t">InvoiceItem</span>.new(<span class="s">&quot;Switch&quot;</span>, <span class="n">nil</span>, <span class="t">BigDecimal</span>.new(<span class="n">45</span>)),
  <span class="t">InvoiceItem</span>.new(<span class="s">&quot;Accessories&quot;</span>, <span class="n">5</span>, <span class="t">BigDecimal</span>.new(<span class="n">64.50</span>)),
]

table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new(invoice,
  omit_last_rule: <span class="n">true</span>,
  border: <span class="t">Tablo</span><span class="t">::</span><span class="t">Border</span>.new(<span class="t">Tablo</span><span class="t">::</span><span class="t">Border</span><span class="t">::</span><span class="t">PreSet</span><span class="t">::</span><span class="t">Fancy</span>),
  title: <span class="t">Tablo</span><span class="t">::</span><span class="t">Heading</span>.new(<span class="s">&quot;\nInvoice\n=======\n&quot;</span>),
  subtitle: <span class="t">Tablo</span><span class="t">::</span><span class="t">Heading</span>.new(<span class="s">&quot;Details&quot;</span>, framed: <span class="n">true</span>)) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="s">&quot;Product&quot;</span>,
    <span class="o">&amp;</span>.product)
  t.add_column(<span class="s">&quot;Quantity&quot;</span>,
    body_formatter: <span class="o">-&gt;</span>(value : <span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>) {
      (value.<span class="k">nil?</span> ? <span class="s">&quot;N/A&quot;</span> : value.to_s)
    }, <span class="o">&amp;</span>.quantity)
  t.add_column(<span class="s">&quot;Price&quot;</span>,
    body_formatter: <span class="o">-&gt;</span>(value : <span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>) {
      <span class="s">&quot;%.2f&quot;</span> <span class="o">%</span> value.<span class="k">as</span>(<span class="t">BigDecimal</span>)
    }, <span class="o">&amp;</span>.price.<span class="k">as</span>(<span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>))
  t.add_column(<span class="n">:total</span>, header: <span class="s">&quot;Total&quot;</span>,
    body_formatter: <span class="o">-&gt;</span>(value : <span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>) {
      value.<span class="k">nil?</span> ? <span class="s">&quot;&quot;</span> : <span class="s">&quot;%.2f&quot;</span> <span class="o">%</span> value.<span class="k">as</span>(<span class="t">BigDecimal</span>)
    }) { <span class="o">|</span>n<span class="o">|</span> n.price.<span class="k">nil?</span> <span class="o">||</span> n.quantity.<span class="k">nil?</span> ? <span class="n">nil</span> : (
    n.price.<span class="k">as</span>(<span class="t">BigDecimal</span>) <span class="o">*</span>
      n.quantity.<span class="k">as</span>(<span class="t">Int32</span>)
  ).<span class="k">as</span>(<span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>) }
<span class="k">end</span>

invoice_summary_definition <span class="o">=</span> [
  <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span><span class="t">::</span><span class="t">UserProc</span>.new(
    proc: <span class="o">-&gt;</span>(tbl : <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>(<span class="t">InvoiceItem</span>)) {
      total_sum <span class="o">=</span> <span class="t">BigDecimal</span>.new(<span class="n">0</span>)
      tbl.column_data(<span class="n">:total</span>).each <span class="k">do</span> <span class="o">|</span>tot<span class="o">|</span>
        total_sum <span class="o">+=</span> tot.<span class="k">as</span>(<span class="t">BigDecimal</span>) <span class="k">unless</span> tot.<span class="k">nil?</span>
      <span class="k">end</span>
      discount <span class="o">=</span> total_sum <span class="o">*</span> <span class="n">0.05</span>
      total_after_discount <span class="o">=</span> total_sum <span class="o">-</span> discount
      tax <span class="o">=</span> total_after_discount <span class="o">*</span> <span class="n">0.2</span>
      total_due <span class="o">=</span> total_after_discount <span class="o">+</span> tax
      {
        <span class="n">:total_sum</span>            <span class="o">=&gt;</span> total_sum.<span class="k">as</span>(<span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>),
        <span class="n">:discount</span>             <span class="o">=&gt;</span> discount.<span class="k">as</span>(<span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>),
        <span class="n">:total_after_discount</span> <span class="o">=&gt;</span> total_after_discount.<span class="k">as</span>(<span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>),
        <span class="n">:tax</span>                  <span class="o">=&gt;</span> tax.<span class="k">as</span>(<span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>),
        <span class="n">:total_due</span>            <span class="o">=&gt;</span> total_due.<span class="k">as</span>(<span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>),
      }
    }),
  <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span><span class="t">::</span><span class="t">BodyColumn</span>.new(<span class="s">&quot;Price&quot;</span>, alignment: <span class="t">Tablo</span><span class="t">::</span><span class="t">Justify</span><span class="t">::</span><span class="t">Right</span>),
  <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span><span class="t">::</span><span class="t">BodyColumn</span>.new(<span class="n">:total</span>, alignment: <span class="t">Tablo</span><span class="t">::</span><span class="t">Justify</span><span class="t">::</span><span class="t">Right</span>,
    formatter: <span class="o">-&gt;</span>(value : <span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>) {
      value.<span class="k">is_a?</span>(<span class="t">String</span>) ? value : (
        value.<span class="k">nil?</span> ? <span class="s">&quot;&quot;</span> : <span class="s">&quot;%.2f&quot;</span> <span class="o">%</span> value.<span class="k">as</span>(<span class="t">BigDecimal</span>)
      )
    },
    styler: <span class="o">-&gt;</span>(_value : <span class="t">Tablo</span><span class="t">::</span><span class="t">CellType</span>, coords : <span class="t">Tablo</span><span class="t">::</span><span class="t">Cell</span><span class="t">::</span><span class="t">Data</span><span class="t">::</span><span class="t">Coords</span>, content : <span class="t">String</span>) {
      <span class="k">case</span> coords.row_index
      <span class="k">when</span> <span class="n">0</span>, <span class="n">2</span>, <span class="n">5</span> <span class="k">then</span> content.colorize.mode(<span class="n">:bold</span>).to_s
      <span class="k">when</span> <span class="n">1</span>       <span class="k">then</span> content.colorize.mode(<span class="n">:italic</span>).to_s
      <span class="k">else</span>              content
      <span class="k">end</span>
    }),
  <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span><span class="t">::</span><span class="t">HeaderColumn</span>.new(<span class="s">&quot;Product&quot;</span>, content: <span class="s">&quot;&quot;</span>),
  <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span><span class="t">::</span><span class="t">HeaderColumn</span>.new(<span class="s">&quot;Quantity&quot;</span>, content: <span class="s">&quot;&quot;</span>),
  <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span><span class="t">::</span><span class="t">HeaderColumn</span>.new(<span class="s">&quot;Price&quot;</span>, content: <span class="s">&quot;Total Invoice&quot;</span>,
    alignment: <span class="t">Tablo</span><span class="t">::</span><span class="t">Justify</span><span class="t">::</span><span class="t">Right</span>),
  <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span><span class="t">::</span><span class="t">HeaderColumn</span>.new(<span class="n">:total</span>, content: <span class="s">&quot;Amounts&quot;</span>),

  <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span><span class="t">::</span><span class="t">BodyRow</span>.new(<span class="s">&quot;Price&quot;</span>, <span class="n">10</span>, <span class="s">&quot;SubTotal&quot;</span>),
  <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span><span class="t">::</span><span class="t">BodyRow</span>.new(<span class="s">&quot;Price&quot;</span>, <span class="n">20</span>, <span class="s">&quot;Discount 5%&quot;</span>),
  <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span><span class="t">::</span><span class="t">BodyRow</span>.new(<span class="s">&quot;Price&quot;</span>, <span class="n">30</span>, <span class="s">&quot;S/T after discount&quot;</span>),
  <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span><span class="t">::</span><span class="t">BodyRow</span>.new(<span class="s">&quot;Price&quot;</span>, <span class="n">40</span>, <span class="s">&quot;Tax (20%)&quot;</span>),
  <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span><span class="t">::</span><span class="t">BodyRow</span>.new(<span class="s">&quot;Price&quot;</span>, <span class="n">60</span>, <span class="s">&quot;Balance due&quot;</span>),

  <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span><span class="t">::</span><span class="t">BodyRow</span>.new(<span class="n">:total</span>, <span class="n">10</span>, <span class="o">-&gt;</span> { <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span>.use(<span class="n">:total_sum</span>) }),
  <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span><span class="t">::</span><span class="t">BodyRow</span>.new(<span class="n">:total</span>, <span class="n">20</span>, <span class="o">-&gt;</span> { <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span>.use(<span class="n">:discount</span>) }),
  <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span><span class="t">::</span><span class="t">BodyRow</span>.new(<span class="n">:total</span>, <span class="n">30</span>, <span class="o">-&gt;</span> { <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span>.use(<span class="n">:total_after_discount</span>) }),
  <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span><span class="t">::</span><span class="t">BodyRow</span>.new(<span class="n">:total</span>, <span class="n">40</span>, <span class="o">-&gt;</span> { <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span>.use(<span class="n">:tax</span>) }),
  <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span><span class="t">::</span><span class="t">BodyRow</span>.new(<span class="n">:total</span>, <span class="n">50</span>, <span class="s">&quot;========&quot;</span>),
  <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span><span class="t">::</span><span class="t">BodyRow</span>.new(<span class="n">:total</span>, <span class="n">60</span>, <span class="o">-&gt;</span> { <span class="t">Tablo</span><span class="t">::</span><span class="t">Summary</span>.use(<span class="n">:total_due</span>) }),
]
table.pack
table.add_summary(invoice_summary_definition,
  title: <span class="t">Tablo</span><span class="t">::</span><span class="t">Heading</span>.new(<span class="s">&quot;Summary&quot;</span>, framed: <span class="n">true</span>))
table.summary.<span class="k">as</span>(<span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>).pack
puts table
puts table.summary</code></pre>
<p>Output:</p>
<p> <img src="assets/images/tutorial_summary.png"> </p>
<p>Let's take a look at the source code.</p>
<p>The first fifty or so lines build a classic Tablo table, defining and
feeding the data structure to be presented.</p>
<p>Next comes the definition of the summary section, in the form of an
array of n <code>struct</code> instances, of 4 different types:</p>
<ul>
<li>the <code>Summary::UserProc</code> type is used to perform calculations, whose
results are stored in a hash internally</li>
<li>the <code>Summary::HeaderColumn</code> type defines attributes (content, format,
style and alignment) for headers</li>
<li>the <code>Summary::BodyColumn</code> type defines attributes (format, style and
alignment) for body rows</li>
<li>the <code>Summary::BodyRow</code> type defines row contents, using data
calculated in <code>Summary::UserProc</code> that can be accessed by key</li>
</ul>
<p>Finally, the last lines display the 2 tables: the main table and the
summary table (linked by the <code>omit_last_rule: true</code> statement). Note
the prior use of the pack method on the main table to optimize column
widths, then again on the summary table to take into account the new
contents of the “Price” column.</p>
<p>For a more in-depth study of this example, detailed explanations are
available in the API.</p>
<h2><a id="transpose" class="anchor" href="#transpose">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Transpose</h2>
<p>Sometimes, it can be useful to be able to invert columns and rows, for
example, when the number of elements in a source row is large, and
therefore unsuitable for horizontal presentation (and provided also that
the number of rows is small).</p>
<p>The <code>transpose</code> method can automatically perform this transformation.
Here is a very simple, contrived but significant, example :</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>
table <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">-1</span>, <span class="n">0</span>, <span class="n">1</span>]) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="s">&quot;Itself&quot;</span>, <span class="o">&amp;</span>.itself)
  t.add_column(<span class="s">&quot;Pred&quot;</span>, <span class="o">&amp;</span>.pred)
  t.add_column(<span class="s">&quot;Succ&quot;</span>, <span class="o">&amp;</span>.succ)
  t.add_column(<span class="s">&quot;Even?&quot;</span>, <span class="o">&amp;</span>.even?)
  t.add_column(<span class="s">&quot;Odd?&quot;</span>, <span class="o">&amp;</span>.odd?)
  t.add_column(<span class="s">&quot;Abs&quot;</span>, <span class="o">&amp;</span>.abs)
  t.add_column(<span class="s">&quot;Double&quot;</span>, <span class="o">&amp;</span>.itself.<span class="o">*</span>(<span class="n">2</span>))
  t.add_column(<span class="s">&quot;Triple&quot;</span>, <span class="o">&amp;</span>.itself.<span class="o">*</span>(<span class="n">3</span>))
  t.add_column(<span class="s">&quot;String 1u&quot;</span>, <span class="o">&amp;</span>.itself.to_s.<span class="o">*</span>(<span class="n">1</span>))
  t.add_column(<span class="s">&quot;String 2u&quot;</span>, <span class="o">&amp;</span>.itself.to_s.<span class="o">*</span>(<span class="n">2</span>))
  t.add_column(<span class="s">&quot;String 3u&quot;</span>, <span class="o">&amp;</span>.itself.to_s.<span class="o">*</span>(<span class="n">3</span>))
  t.add_column(<span class="s">&quot;String 4u&quot;</span>, <span class="o">&amp;</span>.itself.to_s.<span class="o">*</span>(<span class="n">4</span>))
  t.add_column(<span class="s">&quot;String 5u&quot;</span>, <span class="o">&amp;</span>.itself.to_s.<span class="o">*</span>(<span class="n">5</span>))
  t.add_column(<span class="s">&quot;String 6u&quot;</span>, <span class="o">&amp;</span>.itself.to_s.<span class="o">*</span>(<span class="n">6</span>))
  t.add_column(<span class="s">&quot;String 5d&quot;</span>, <span class="o">&amp;</span>.itself.to_s.<span class="o">*</span>(<span class="n">5</span>))
  t.add_column(<span class="s">&quot;String 4d&quot;</span>, <span class="o">&amp;</span>.itself.to_s.<span class="o">*</span>(<span class="n">4</span>))
  t.add_column(<span class="s">&quot;String 3d&quot;</span>, <span class="o">&amp;</span>.itself.to_s.<span class="o">*</span>(<span class="n">3</span>))
  t.add_column(<span class="s">&quot;String 2d&quot;</span>, <span class="o">&amp;</span>.itself.to_s.<span class="o">*</span>(<span class="n">2</span>))
  t.add_column(<span class="s">&quot;String 1d&quot;</span>, <span class="o">&amp;</span>.itself.to_s.<span class="o">*</span>(<span class="n">1</span>))
<span class="k">end</span></code></pre>
<p>Displaying this table in the standard way produces a table with a total
length of 286 characters, hardly compatible with the width of current
terminals.</p>
<pre><code class="language-crystal">puts table
puts <span class="s">&quot;Table width = </span><span class="i">#{</span>table.total_table_width<span class="i">}</span><span class="s">&quot;</span></code></pre>
<pre><code class="language-crystal">+--------------+--------------+-------------  //  -------------+--------------+--------------+
|       Itself |         Pred |         Succ  //  String 3d    | String 2d    | String 1d    |
+--------------+--------------+-------------  //  -------------+--------------+--------------+
|           -1 |           -2 |            0  //  -1-1-1       | -1-1         | -1           |
|            0 |           -1 |            1  //  000          | 00           | 0            |
|            1 |            0 |            2  //  111          | 11           | 1            |
+--------------+--------------+-------------  //  -------------+--------------+--------------+
table width = 286</code></pre>
<p>Using the “transpose” method produces a much clearer result:</p>
<pre><code class="language-crystal">transposed_table <span class="o">=</span> table.transpose
puts transposed_table
puts <span class="s">&quot;Table width = </span><span class="i">#{</span>transposed_table.total_table_width<span class="i">}</span><span class="s">&quot;</span></code></pre>
<pre><code class="language-crystal">+-----------+--------------+--------------+--------------+
|           |           -1 |            0 |            1 |
+-----------+--------------+--------------+--------------+
| Itself    |           -1 |            0 |            1 |
| Pred      |           -2 |           -1 |            0 |
| Succ      |            0 |            1 |            2 |
| Even?     |     false    |     true     |     false    |
| Odd?      |     true     |     false    |     true     |
| Abs       |            1 |            0 |            1 |
| Double    |           -2 |            0 |            2 |
| Triple    |           -3 |            0 |            3 |
| String 1u | -1           | 0            | 1            |
| String 2u | -1-1         | 00           | 11           |
| String 3u | -1-1-1       | 000          | 111          |
| String 4u | -1-1-1-1     | 0000         | 1111         |
| String 5u | -1-1-1-1-1   | 00000        | 11111        |
| String 6u | -1-1-1-1-1-1 | 000000       | 111111       |
| String 5d | -1-1-1-1-1   | 00000        | 11111        |
| String 4d | -1-1-1-1     | 0000         | 1111         |
| String 3d | -1-1-1       | 000          | 111          |
| String 2d | -1-1         | 00           | 11           |
| String 1d | -1           | 0            | 1            |
+-----------+--------------+--------------+--------------+
Table width = 58</code></pre>
<p>See API for details.</p>
<h2><a id="columns-selection-and-ordering" class="anchor" href="#columns-selection-and-ordering">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Columns selection and ordering</h2>
<p>Sometimes we may need to present a table in different ways and, rather
than redefining a new table each time, it's more economical to define
the table in its most “complete” configuration, then, when it's time to
display it, select and order the columns to be presented.</p>
<p><code>Table#using_columns</code> and <code>Table#using_column_indexes</code> methods do just that!</p>
<p>If defined, groups are preserved if no re-ordering required.</p>
<p>See API for examples.</p>
<h2><a id="tips-and-tricks" class="anchor" href="#tips-and-tricks">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Tips and tricks</h2>
<p>Here are interesting things to try...</p>
<h3><a id="data-sources" class="anchor" href="#data-sources">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Data sources</h3>
<p>A table may be built once, and used by different data sources, at the
condition that these sources have exactly the same type.
The <code>Table#sources=</code> method allows to change data sources.</p>
<p>(The <code>Table#sources</code> method allows to access data directly, for example
in <code>Summary.UserProc</code> struct initialization - see API)</p>
<h3><a id="tables-into-tables" class="anchor" href="#tables-into-tables">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Tables into tables</h3>
<p>Formatting a table (or any other formatted data) inside a cell of another table is perfectly possible.</p>
<p>Here is an example :</p>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;tablo&quot;</span>

<span class="k">def</span> <span class="m">my_string</span>
  <span class="s">&quot;My formatted string&quot;</span>
<span class="k">end</span>

<span class="k">def</span> <span class="m">your_string</span>
  <span class="s">&quot;Your formatted string&quot;</span>
<span class="k">end</span>

tslave <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="s">&quot;abc&quot;</span>]) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="s">&quot;itself&quot;</span>, <span class="o">&amp;</span>.itself)
  t.add_column(<span class="s">&quot;my_string&quot;</span>) { my_string }
<span class="k">end</span>
tmain <span class="o">=</span> <span class="t">Tablo</span><span class="t">::</span><span class="t">Table</span>.new([<span class="n">1</span>],
  title: <span class="t">Tablo</span><span class="t">::</span><span class="t">Heading</span>.new(<span class="s">&quot;tmain&quot;</span>, framed: <span class="n">true</span>)) <span class="k">do</span> <span class="o">|</span>t<span class="o">|</span>
  t.add_column(<span class="s">&quot;tslave&quot;</span>) { tslave.to_s }
  t.add_column(<span class="s">&quot;your_string&quot;</span>) { your_string }
<span class="k">end</span>
puts tmain.pack</code></pre>
<p><em><em>Here, the <code>[1]</code> is a fake, as it is never used.</em></em></p>
<p>Output:</p>
<pre><code class="language-crystal">+---------------------------------------------------------+
|                          tmain                          |
+---------------------------------+-----------------------+
| tslave                          | your_string           |
+---------------------------------+-----------------------+
| +--------------+--------------+ | Your formatted string |
| | itself       | my_string    | |                       |
| +--------------+--------------+ |                       |
| | abc          | My           | |                       |
| |              | formatted    | |                       |
| |              | string       | |                       |
| +--------------+--------------+ |                       |
+---------------------------------+-----------------------+</code></pre>
<p>This can lead to some interesting formatting possibilities!</p>
</div>
</body>
</html>
